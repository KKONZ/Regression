---
title: "Regression Course Assignment"
author: "Karl Konz"
date: "November 6, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
options(warn=-1)
set.seed(1234)
cars <- mtcars
cars$am <- as.character(cars$am)
 
t.test(subset(cars,cars$am=="1",select=c(mpg))[,1],
            subset(cars,cars$am=="0",select=c(mpg))[,1])

```

We can see that from above the t test for automatic and manual transmissions in the mtcars data yeilds a p value below  the level of significance of $\alpha$ = .05. This suggests we have evidence to reject the null hypothesis that the mean difference between the 2 transmission types are 0. We can therefore reject the null hypothesis for this test. 
Next we will use Stepwise comparison using AIC to select the final 
```{r}

library("caret")
train(mpg~.,data = mtcars, method = "lmStepAIC")
summary(fit <- lm(mpg~ wt + qsec + am, data = mtcars))

par(mfrow = c(2,2))
plot(fit)
```


Next test if there is a significant difference if automatic or manual transmissions term in this model performing a wald test.

```{r}
library(aod)
wald.test(b = coef(fit), Sigma = vcov(fit), Terms = 4)
```

From the output above we can see there is a slight but significant, at a 5% level of significance, for the am term in this model.